CMIP5 product detection
=======================

drslib includes an algorithm for detecting the required CMIP5 product
from filenames generated by CMOR2_ developed by Martin Juckes.  The
module :mod:`drslib.p_cmip5` contains an API to the algorithm and
``drs_tool`` will use the algorithm to allocate a product for incoming
data when used with the ``--detect-product`` option.

Overview
--------

**Todo:** Contribution from Martin

Configuration
-------------

Product detection requires extra information to be configured about
the CMIP5 experiment and the data being processed.  Before first using
the product detection feature you should initialise the CMIP5
experiment description data using ``drs_tool init``:

.. code-block:: bash

  $ drs_tool init --shelve-dir=DIR

where ``DIR`` is a directory suitable for containing the data files.  On an ESG datanode a suitable command might be:

.. code-block:: bash

  $ drs_tool init --shelve-dir=/usr/local/share/p_cmip5/data

In addition to the shelve directory ``p_cmip5`` requires additional
information about the model output being processed to be included in
an external configuration file (see `Input configuration file`_).  

Both these parameters can be configured using metaconfig as follows:

.. code-block:: ini

  [metaconfig]
  configs = drslib

  [drslib:p_cmip5]
  shelve-dir = /usr/local/share/p_cmip5/data
  config = /usr/local/share/p_cmip5/model.ini



Input configuration file
------------------------

**Todo:** Contribution from Martin


Invoking drs_tool with product detection
----------------------------------------

**Todo:**
